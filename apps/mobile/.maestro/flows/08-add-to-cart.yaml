# =============================================================================
# FLOW 08: Ajout d'articles au panier
# =============================================================================
# Approche: Utilisation des accessibilityLabel et selecteurs de position
# =============================================================================
appId: com.oneeats.mobile
name: "08 - Add Items to Cart"
tags:
  - cart
  - smoke

---

# SETUP
- launchApp:
    clearState: true

- extendedWaitUntil:
    visible: ".*"
    timeout: 15000

- runFlow:
    when:
      visible: "Continuer sans compte"
    commands:
      - tapOn: "Continuer sans compte"

- extendedWaitUntil:
    visible: "Accueil"
    timeout: 15000

# Attendre le chargement des restaurants
- extendedWaitUntil:
    visible: ".*proximit.*"
    timeout: 20000
    optional: true

# Scroll et ouvrir un restaurant via accessibilityLabel
- scroll

- tapOn:
    label: "Restaurant.*"
    index: 0
    optional: true

- extendedWaitUntil:
    visible: "Menu"
    timeout: 10000
    optional: true

- takeScreenshot: "08-restaurant-menu"

# Scroll jusqu'au menu
- scroll

# Ajouter un article via accessibilityLabel "Ajouter {nom} au panier"
- tapOn:
    label: "Ajouter.*panier"
    index: 0
    optional: true

- takeScreenshot: "08-item-added"

# Retour a l'accueil pour voir la tab bar
- back

- extendedWaitUntil:
    visible: "Accueil"
    timeout: 5000

# Aller au panier
- tapOn: "Panier"

- extendedWaitUntil:
    visible: "Panier"
    timeout: 5000

- takeScreenshot: "08-cart-view"
