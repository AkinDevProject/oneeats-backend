# =============================================================================
# FLOW 04: Authentification - Mode Invite (Skip)
# =============================================================================
# Teste le parcours "Continuer sans compte" pour naviguer en mode invite
# Tags: smoke, auth
# Prerequis: Aucun
# =============================================================================

appId: com.oneeats.mobile
name: "04 - Authentication Skip (Guest Mode)"
tags:
  - smoke
  - auth

---

# -----------------------------------------------------------------------------
# SETUP: Lancement avec etat neuf
# -----------------------------------------------------------------------------
- launchApp:
    clearState: true
    clearKeychain: true

# -----------------------------------------------------------------------------
# STEP 1: Arriver sur l'ecran de connexion
# -----------------------------------------------------------------------------
- extendedWaitUntil:
    visible: ".*"
    timeout: 15000

# -----------------------------------------------------------------------------
# STEP 2: Cliquer sur "Continuer sans compte"
# -----------------------------------------------------------------------------
- runFlow:
    when:
      visible: "Continuer sans compte"
    commands:
      - tapOn: "Continuer sans compte"
      - takeScreenshot: "04-skip-tapped"

# -----------------------------------------------------------------------------
# STEP 3: Verifier la redirection vers l'accueil
# -----------------------------------------------------------------------------
- extendedWaitUntil:
    visible: ".*proximit.*"
    timeout: 10000

- takeScreenshot: "04-guest-home"

# -----------------------------------------------------------------------------
# STEP 4: Verifier qu'on peut naviguer normalement
# -----------------------------------------------------------------------------
# Onglet Panier
- tapOn: "Panier"

- extendedWaitUntil:
    visible: "Panier"
    timeout: 5000

# Onglet Compte (anciennement Profil)
- tapOn: "Compte"

- extendedWaitUntil:
    visible: "Compte"
    timeout: 5000

- takeScreenshot: "04-guest-compte"

# -----------------------------------------------------------------------------
# STEP 5: Retour a l'accueil et verifier la navigation restaurants
# -----------------------------------------------------------------------------
- tapOn: "Accueil"

- extendedWaitUntil:
    visible: ".*proximit.*"
    timeout: 5000

# Verifier qu'on peut voir les restaurants
- scroll

- takeScreenshot: "04-guest-browsing"
