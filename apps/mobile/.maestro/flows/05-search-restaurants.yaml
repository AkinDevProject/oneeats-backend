# =============================================================================
# FLOW 05: Recherche de restaurants
# =============================================================================
# Teste la fonctionnalite de recherche de restaurants
# Tags: search, e2e
# Prerequis: App sur l'ecran d'accueil
# =============================================================================

appId: com.oneeats.mobile
name: "05 - Search Restaurants"
tags:
  - search
  - e2e
  - regression

---

# -----------------------------------------------------------------------------
# SETUP: Lancement et acces a l'accueil
# -----------------------------------------------------------------------------
- launchApp:
    clearState: true

- extendedWaitUntil:
    visible: ".*"
    timeout: 45000

# Skip auth si necessaire
- runFlow:
    when:
      visible: "Continuer sans compte"
    commands:
      - tapOn: "Continuer sans compte"

# Attendre l'onglet Accueil (plus fiable que le contenu)
- extendedWaitUntil:
    visible: "Accueil"
    timeout: 30000

- takeScreenshot: "05-home-loaded"

# Attendre le chargement des restaurants (optionnel)
- extendedWaitUntil:
    visible: ".*"
    timeout: 30000
    optional: true

# -----------------------------------------------------------------------------
# TEST 1: Barre de recherche visible
# -----------------------------------------------------------------------------
- takeScreenshot: "05-search-bar-visible"

# -----------------------------------------------------------------------------
# TEST 2: Recherche par nom de restaurant
# Note: Le placeholder est "Rechercher un restaurant..."
# -----------------------------------------------------------------------------
- tapOn:
    text: "Rechercher"
    optional: true

- inputText: "Pizza"

- takeScreenshot: "05-search-pizza-results"

# -----------------------------------------------------------------------------
# TEST 3: Retour et nouvelle recherche
# -----------------------------------------------------------------------------
- hideKeyboard

- tapOn: "Accueil"

- extendedWaitUntil:
    visible: "Accueil"
    timeout: 15000

- takeScreenshot: "05-search-complete"
